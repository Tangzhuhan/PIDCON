# PID Temperature Control System

## 项目说明
这是一个基于 PyQt5 的温度控制系统，使用 PID 控制器来调节温度。系统支持多个温度传感器的监控和控制，以及实时数据采集和显示。

## 打包成 Windows 可执行文件说明

### 1. 环境准备
- 安装 Python 3.8 或更高版本
- 安装 PyInstaller: `pip install pyinstaller`
- 安装所有项目依赖:
  ```
  pip install PyQt5
  pip install pyqtgraph
  pip install pyserial
  pip install pandas
  pip install appdirs
  ```

### 2. 代码修改注意事项
1. 路径处理
   - 所有文件路径需要使用 `os.path.join()` 来构建
   - 避免使用硬编码的路径分隔符（如 `/` 或 `\`）
   - 使用 `os.path.expanduser("~")` 来获取用户主目录

2. 串口处理
   - Windows 下的串口名称格式为 `COMx`（如 COM1, COM2）
   - 确保串口检测代码兼容 Windows 格式

3. 配置文件路径
   - 使用 `appdirs` 库来获取正确的配置文件路径
   - 确保有写入权限

### 3. 打包步骤
1. 创建打包配置文件 `pid_control.spec`:
   ```
   pyinstaller --name=pid_control --windowed --onefile --add-data "icon.ico;." main.py
   ```

2. 执行打包命令:
   ```
   pyinstaller pid_control.spec
   ```

3. 打包完成后，可执行文件将在 `dist` 目录中生成

### 4. 依赖文件处理
- 确保所有必要的资源文件（如图标、配置文件等）都包含在打包中
- 使用 `--add-data` 参数添加额外文件
- 确保所有 Python 模块都被正确包含

### 5. 测试注意事项
1. 在打包前进行完整测试
   - 测试所有功能
   - 测试串口通信
   - 测试数据保存和读取
   - 测试图表显示

2. 打包后测试
   - 在干净的 Windows 系统上测试
   - 测试安装和卸载过程
   - 测试所有功能是否正常工作

### 6. 发布准备
1. 创建安装程序
   - 使用 Inno Setup 或 NSIS 创建安装程序
   - 包含必要的依赖项
   - 添加卸载功能

2. 文档准备
   - 准备用户手册
   - 准备安装说明
   - 准备故障排除指南

### 7. 常见问题解决
1. 如果程序无法启动
   - 检查是否所有依赖都已正确安装
   - 检查是否有正确的权限
   - 检查日志文件中的错误信息

2. 如果串口无法识别
   - 检查设备管理器中的串口设置
   - 确保有正确的驱动程序
   - 检查权限设置

3. 如果数据保存失败
   - 检查目标目录的写入权限
   - 检查磁盘空间
   - 检查文件是否被其他程序占用

### 8. 安全注意事项
1. 权限管理
   - 确保程序以适当的权限运行
   - 避免使用管理员权限运行

2. 数据安全
   - 确保配置文件的安全存储
   - 实现数据备份机制

3. 错误处理
   - 实现完善的错误处理机制
   - 添加日志记录功能

### 9. 性能优化建议
1. 内存管理
   - 定期清理不需要的数据
   - 优化数据结构

2. 响应速度
   - 优化图表更新频率
   - 使用线程处理耗时操作

3. 资源使用
   - 优化文件读写操作
   - 减少不必要的磁盘操作

### 10. 更新和维护
1. 版本控制
   - 实现版本检查机制
   - 提供更新通知

2. 错误报告
   - 实现错误报告机制
   - 收集用户反馈

3. 定期维护
   - 定期检查日志
   - 更新依赖库
   - 修复已知问题

## 程序分发和使用说明

### 对于程序打包者（开发者）
1. 安装Python 3.9或更高版本
   - 访问 https://www.python.org/downloads/
   - 下载并安装Python 3.9
   - 安装时勾选"Add Python to PATH"

2. 安装必要的Python包
   ```bash
   pip install pyserial pyqtgraph pandas PyQt5 pyinstaller
   ```

3. 打包程序
   - 打开命令提示符（CMD）
   - 进入程序目录
   - 运行打包命令：
     ```bash
     pyinstaller --name=PID_Temperature_Control --windowed --onefile main.py
     ```
   - 打包完成后，在 `dist` 目录下会生成 `PID_Temperature_Control.exe` 文件

4. 分发程序
   - 将 `dist` 目录下的 `PID_Temperature_Control.exe` 文件复制给其他用户
   - 建议同时提供串口驱动安装包

### 对于程序使用者（最终用户）
1. 安装必要的驱动
   - 安装温度传感器驱动
   - 安装电源发生器驱动

2. 运行程序
   - 双击运行 `PID_Temperature_Control.exe`
   - 首次运行时可能需要管理员权限
   - 确保已连接温度传感器和电源发生器
   - 选择正确的串口
   - 设置PID参数和控制参数
   - 点击"Start"开始控制

### 注意事项
1. 程序使用者不需要安装Python或任何Python包
2. 确保已安装正确的串口驱动
3. 如果遇到问题，请检查：
   - 串口连接是否正常
   - 驱动是否安装正确
   - 是否有其他程序占用串口

### 常见问题
1. 程序无法启动
   - 尝试以管理员身份运行
   - 检查是否有杀毒软件拦截

2. 无法识别串口
   - 检查设备管理器中的串口设备
   - 确保驱动安装正确
   - 重启程序或电脑

3. 数据保存失败
   - 检查保存目录是否有写入权限
   - 确保磁盘空间充足

### 技术支持
如有问题，请联系技术支持。


